# FeedMedia 产品设计文档

## 1. 概述

`FeedMedia` 是一个为 Flutter 设计的综合性媒体内容展示库，旨在提供流畅、高性能的用户体验。它包含两种主要内容展示模式：

*   **沉浸式媒体流 (FeedMediaPageView)**: 提供高度沉浸式、可垂直滚动的视频/图片信息流体验。
*   **瀑布流信息展示 (FeedWaterView)**: 提供高效、灵活的多列瀑布流布局，适用于内容发现和浏览场景。

## 2. 核心功能

### 2.1 沉浸式媒体流 (FeedMediaPageView)
- **无缝垂直滚动**: 用户可通过上下滑动无缝切换视频和图片内容。
- **懒加载**: 滚动到内容末尾时，自动加载下一页数据。

### 2.2 视频体验
- **自动播放/暂停**: 视频进入可视区域时自动播放，滑出时自动暂停。
- **全屏点击交互**:
  - **单击**: 切换播放/暂停状态。暂停时，屏幕中央会显示一个播放图标。
  - **双击**: 触发点赞，并显示爱心动画。
  - **长按**: 弹出功能菜单（如调整播放速度、保存视频等）。
- **进度条**:
  - **播放时**: 底部显示一个纤细的白色进度条。
  - **暂停时**: 进度条上会出现一个可拖动的小圆球，用户可直接拖动以调整视频进度。
- **音频指示器**: 左下角显示动态的音频指示器，并提供静音切换功能。

### 2.3 图片体验
- **多图滑动**: 支持在单个媒体卡片内左右滑动浏览多张图片。
- **动画指示器**: 多图模式下，底部会显示一个动画圆点指示器。
- **长按菜单**: 长按图片可弹出专属的功能菜单。

### 2.4 用户交互 (UI)
- **信息展示**: 底部展示标题、描述和可点击的话题标签。
- **社交操作**: 左侧提供一列交互按钮，包括用户头像、关注（带状态切换）、点赞（带动画）、评论和分享。

### 2.5 健壮性
- **错误处理**: 优雅地处理网络和媒体加载失败的情况。

### 2.6 瀑布流信息展示 (FeedWaterView)
- **目标用户与场景**: 适用于需要展示大量异构内容，并希望用户能够快速浏览和发现信息的场景，例如电商商品列表、资讯流、图片社区的“发现”页面等。
- **核心功能**:
    - **多列布局**: 支持自定义列数，实现多列内容展示。
    - **动态高度**: 每个瀑布流项的高度根据内容自适应，无需固定高度。
    - **无限滚动**: 内置加载更多机制，支持自动加载下一页数据。
    - **广告支持**: 能够识别并展示广告类型的卡片，支持差异化样式。
    - **灵活卡片**: 支持自定义卡片内容，可展示图片、视频缩略图、文本等多种信息。
    - **间距控制**: 支持自定义瀑布流项之间的水平和垂直间距。
- **设计决策**:
    - **布局选择**: 采用瀑布流布局以最大化屏幕空间利用率，并提供更丰富的视觉呈现。
    - **技术选型**: 基于 `flutter_staggered_grid_view` 进行封装，利用其高性能和灵活性。
- **衡量指标**:
    - 用户停留时长。
    - 内容点击率。
    - 页面滑动深度。

---

## 3. 未来版本规划 (Roadmap)

### V1.2 - 交互深化与体验增强

- **🎯 目标**: 完善核心交互链路，提供更丰富的播放器控制功能。
- **功能列表**:
  - **评论功能**: 实现从底部滑出的评论列表弹窗，支持查看和滚动浏览评论。
  - **播放速度控制**: 在长按菜单中加入不同倍速（如 0.75x, 1.5x, 2.0x）的选项。
  - **视频封面图**: 在视频开始播放前，加载并显示高质量的封面图，提升首屏观感。
  - **自动连播**: 当前视频播放结束后，可自动滑动到下一个视频，提供连续的观看体验。
  - **分享功能集成**: 对接系统分享菜单，允许用户将感兴趣的内容分享到其他平台。

### V2.0 - 性能飞跃与商业化探索

- **🎯 目标**: 追求极致的性能表现，并为未来的商业化需求奠定基础。
- **功能列表**:
  - **智能预加载**: 实现对下一个视频内容的智能预加载和缓存，做到“零等待”的播放体验。
  - **视频缓存管理**: 提供更精细化的缓存策略，如设置缓存上限、自动清理过期缓存等。
  - **广告内容支持**: 能够在信息流中无缝插入广告类内容（如视频、图片卡片），并支持相应的点击和跳转逻辑。
  - **弹幕系统**: 集成轻量级的弹幕功能，允许用户在观看视频时发送和查看实时弹幕，增强社区互动氛围。
  - **瀑布流组件增强**: 优化 `FeedWaterView` 的性能和功能，例如支持下拉刷新、自定义加载更多指示器等。

### V3.0 - 生态构建与平台扩展

- **🎯 目标**: 将组件从一个播放器扩展为一个小型内容生态，并探索跨平台能力。
- **功能列表**:
  - **内容创作入口**: 在UI中增加内容上传入口，引导用户从消费者转变为创作者。
  - **多平台适配**: 优化组件在 Web 和桌面端的兼容性和体验。
  - **个性化推荐**: 预留数据接口，为未来接入个性化推荐算法做准备。
  - **主题化与定制**: 提供更丰富的UI定制选项，如暗黑模式（Dark Mode）、自定义主题色等，以适应不同App的视觉风格。

## 4. 长期优化方向

- **可访问性 (Accessibility)**: 持续优化组件对屏幕阅读器等辅助功能的支持，确保所有用户都能无障碍使用。
- **模块化与解耦**: 进一步提升组件的模块化程度，使其核心功能（如视频播放器、数据加载模块）可以被独立引用和替换。
- **国际化 (i18n)**: 为所有面向用户的文本（如菜单项、提示信息）提供国际化支持。
- **数据驱动决策**: 建立完善的数据埋点体系，通过分析用户行为数据（如播放完成率、各按钮点击率）来指导未来的产品迭代方向。
